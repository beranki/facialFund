from website import create_app

app = create_app()

if __name__ == "__main__":
    app.run(debug=True)


"""
Model: "siam_network"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_img (InputLayer)          [(None, 105, 105, 3) 0
__________________________________________________________________________________________________
valid_img (InputLayer)          [(None, 105, 105, 3) 0
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 96, 96, 64)   19264       input_img[0][0]
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 96, 96, 64)   19264       valid_img[0][0]
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 48, 48, 64)   0           conv2d[0][0]
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 48, 48, 64)   0           conv2d_4[0][0]
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 42, 42, 128)  401536      max_pooling2d[0][0]
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 42, 42, 128)  401536      max_pooling2d_3[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 21, 21, 128)  0           conv2d_1[0][0]
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 21, 21, 128)  0           conv2d_5[0][0]
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 18, 18, 128)  262272      max_pooling2d_1[0][0]
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 18, 18, 128)  262272      max_pooling2d_4[0][0]
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 9, 9, 128)    0           conv2d_2[0][0]
__________________________________________________________________________________________________
max_pooling2d_5 (MaxPooling2D)  (None, 9, 9, 128)    0           conv2d_6[0][0]
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 6, 6, 256)    524544      max_pooling2d_2[0][0]
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 6, 6, 256)    524544      max_pooling2d_5[0][0]
__________________________________________________________________________________________________
flatten (Flatten)               (None, 9216)         0           conv2d_3[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 9216)         0           conv2d_7[0][0]
__________________________________________________________________________________________________
dense (Dense)                   (None, 4096)         37752832    flatten[0][0]
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 4096)         37752832    flatten_1[0][0]
__________________________________________________________________________________________________
tf.math.subtract (TFOpLambda)   (None, 4096)         0           dense[0][0]
                                                                 dense_1[0][0]
__________________________________________________________________________________________________
tf.math.abs (TFOpLambda)        (None, 4096)         0           tf.math.subtract[0][0]
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            4097        tf.math.abs[0][0]
==================================================================================================
Total params: 77,924,993
Trainable params: 77,924,993
Non-trainable params: 0
__________________________________________________________________________________________________
None
"""